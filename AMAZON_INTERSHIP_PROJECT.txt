
 CREATE DATABASE ST_AMAZON;
 
 USE ST_AMAZON;
 
CREATE  OR REPLACE TABLE AMAZON_CUSTOMERS(
  REGION VARCHAR(40),
  COUNTRY VARCHAR(40),
  ITEM_TYPE VARCHAR(40),
  SALES_CHANNEL VARCHAR(40),
  ORDER_PRIOROTY VARCHAR(40),
  ORDER_DATE DATE,
  ORDER_ID INT NOT NULL,
  SHIP_DATE DATE,
  UNIT_SOLD DECIMAL,
  UNIT_PRICE DECIMAL,
  UNIT_COST DECIMAL,
  TOTAL_REVENUE DECIMAL,
  TOTAL_COST DECIMAL,
  TOTAL_PROFIT DECIMAL);

SELECT * FROM AMAZON_CUSTOMERS;

---- LIST OF UNIT_SOLD,UNIT_PRICE,UNIT_COST
SELECT AC.UNIT_SOLD AS UNITS_SOLD,
AC.UNIT_PRICE AS UNITS_PRIZE, 
AC.UNIT_COST AS UNITS_COST
FROM AMAZON_CUSTOMERS AC;


--- TOTAL SALE 
SELECT SUM(UNIT_PRICE * UNIT_SOLD) AS TOTAL_SALES FROM AMAZON_CUSTOMERS;


--- YEARLY-MONTHLY WISE SALES TREND
SELECT SUM(UNIT_PRICE * UNIT_SOLD) AS TOTAL_SALES,
YEAR(ORDER_DATE)  AS YEAR_WISE_LIST,
MONTH(ORDER_DATE)  AS MONTH_WISE_LIST
FROM AMAZON_CUSTOMERS
GROUP BY  ORDER_DATE,UNIT_PRICE * UNIT_SOLD
ORDER BY YEAR(ORDER_DATE);


 ---QUATER SALES BY ALL YEARS
SELECT QUARTER(ORDER_DATE) AS QTR,SUM(UNIT_PRICE * UNIT_SOLD) AS TOTAL_SALES
FROM AMAZON_CUSTOMERS
GROUP BY ORDER_DATE,UNIT_PRICE,UNIT_SOLD;



---MONTHWISE SALES 
SELECT SUM(UNIT_PRICE * UNIT_SOLD) AS TOTAL_SALES,
MONTH(ORDER_DATE)  AS MONTH
FROM AMAZON_CUSTOMERS
GROUP BY  ORDER_DATE,UNIT_PRICE * UNIT_SOLD;


---YEAR WISE SALES 
SELECT SUM(UNIT_PRICE * UNIT_SOLD) AS TOTAL_SALES,
YEAR(ORDER_DATE)  AS YEAR
FROM AMAZON_CUSTOMERS
GROUP BY  ORDER_DATE,UNIT_PRICE * UNIT_SOLD
ORDER BY YEAR(ORDER_DATE) DESC;